var detail={MAX_QUANTITY:99999,is_member:!1,isLogin:!1,init:function(){this.initData(),this.initEvent()},initData:function(){var i,a="",e="",s=this;s.searchStr=location.search,s.goodsId=Okay.util.searchUrl(location.search).goodsId,(s.token=Okay.util.getCookie("mall_token"))&&(s.isLogin=!0),Okay.Ajax("post","/index.php?m=OkayMall&c=mobileGoods&a=getGoodsDetail",{goodsId:s.goodsId,mall_token:s.token}).done(function(n){i=n.data.goodsInfo,s.is_member=n.data.isMember,s.token&&(0==n.goodsSum?$(".count").hide().parent().show():$(".count").html(n.goodsSum>99?"99+":n.goodsSum).parent().show());for(var o=0,t=i.imgList.length;o<t;o++)e+='<div><img src="'+i.imgList[o]+'"></div>';$(".swipe-wrap").html(e),s.initSwipe(),a+='<div class="product-name">'+i.goodsName+"</div>",i.isMain?a+='<div class="price-wrapper"><div class="member-price">会员价￥'+i.memberPrice+'</div><div class="price '+(s.is_member?"is-member":"")+'">原价￥'+i.shopPrice+"</div></div>":a+='<div class="price-wrapper"><div class="member-price">￥'+i.memberPrice+"</div></div>",a+='<div class="num-wrapper"><i class="icon icon-minus disabled"></i><input type="tel" class="num" value="1" maxlength="5" /><i class="icon icon-plus"></i></div>',a+='<div class="produce-info clearfix"><span>上架时间：'+i.saleTime.split(" ")[0]+"</span><span>商品品牌：OKAY</span></div>",$(".main").html(a),s.is_member&&$("#addCart").addClass("btn-full").prev().remove(),$(".btn-wrapper").show()})},initSwipe:function(){Okay.util;var i,a='<div class="swipe-banner">',e=$("#slider .swipe-wrap").children().length,s=new Swipe(document.getElementById("slider"),{speed:500,auto:4e3,callback:function(i,a){2==e?$(".swipe-circle").eq(s.getPos()%2).addClass("active").siblings().removeClass("active"):$(".swipe-circle").eq(s.getPos()).addClass("active").siblings().removeClass("active")},transitionEnd:function(i,a){}});i=2==e?2:$("#slider .swipe-wrap").children().length;for(var n=0;n<i;n++)a+='<span class="swipe-circle '+(0==n?"active":"")+'"></span>';a+="</div>",$("#slider").append(a)},initEvent:function(){function i(i,a,e){var s=a?"&num="+$(".num").val():"";window.location.href=i+location.search+(location.search?"&":"?")+"returnURL="+(e?"cart.html":location.pathname.substring(1))+s}var a=this,e=$(".main");$(".back").on("tap",function(){window.history.back()}),e.on("input",".num",function(){var i=$(this).val();i=i.replace(/[^\d]/g,""),$(this).val(i)}).on("blur",".num",function(){var i=$(this).val();0==i||1==i?($(this).val("1"),$(this).prev().addClass("disabled")):i==a.MAX_QUANTITY?$(this).next().addClass("disabled"):$(this).prev().removeClass("disabled").end().next().removeClass("disabled")}).on("tap",".icon-plus",function(){if(!$(this).hasClass("disabled")){var i=$(this).prev(),e=i.val();e<a.MAX_QUANTITY&&(i.val(++e),e==a.MAX_QUANTITY&&$(this).addClass("disabled"),i.prev().removeClass("disabled"))}}).on("tap",".icon-minus",function(){if(!$(this).hasClass("disabled")){var i=$(this).next(),a=i.val();a>1&&(i.val(--a),1==a&&$(this).addClass("disabled"),i.next().removeClass("disabled"))}}),$("#member").on("tap",function(){a.isLogin?i("member.html"):window.location.href="login.html?returnURL=member.html&"+a.searchStr.substring(1)}),$("#addCart").on("tap",function(){a.isLogin?Okay.Ajax("post","/index.php?m=OkayMall&c=mobileCart&a=add",{gcount:$(".num").val(),goodsId:a.goodsId,mall_token:a.token}).done(function(i){window.location.href="cart.html"}):Okay.Ajax("post","/index.php?m=OkayMall&c=mobileGoods&a=checkGoodsStock",{num:$(".num").val(),goodsId:a.goodsId}).done(function(a){i("login.html",!0,!0)})}),$("#user").on("tap",function(){a.isLogin?window.location.href="user.html"+location.search+"&returnURL=product.html":window.location.href="login.html"+location.search+"&returnURL=product.html"})}};