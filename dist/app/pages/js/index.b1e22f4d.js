var index={upperLimit:100,scrollElem:$("#to-top"),isLogin:!1,user:null,isShareOpen:!1,init:function(){this.checkLogin(),this.initSwipe(),this.initEvent()},checkLogin:function(){function e(){Okay.Ajax("post","/index.php?m=OkayMall&c=mobileCart&a=getGoodsSum",{mall_token:i.token},!1).done(function(e){0==e.goodsSum?$(".num").hide().parent().show():$(".num").html(e.goodsSum>99?"99+":e.goodsSum).parent().show()})}var n,i=this;Okay.util.isInApp()?(Okay.util.isIOS()?(this.user=window.resultIos,this.isLogin=!0):(n=okay.getJsonData(),this.user=JSON.parse(n),this.isLogin=!0),$.ajax({type:"post",url:Okay.util.URL+"/index.php?c=MobileUsers&a=login",data:{token:this.user.token,systemId:this.user.uid}}).done(function(n){/200$/.test(n.status)?(i.token=n.mall_token,Okay.util.setCookie("mall_token",n.mall_token,24),e()):Okay.popUp(error)}).fail(function(e,n){var i="parsererror"==n?"数据返回格式错误":"网络异常";Okay.popUp(i)})):($(".app-download").removeClass("dn"),(i.token=Okay.util.getCookie("mall_token"))?(this.isLogin=!0,e()):this.isLogin=!1),$("#menu").append(Okay.util.createMenuList())},initSwipe:function(){var e,n='<div class="swipe-banner">',i=new Swipe(document.getElementById("slider"),{speed:500,auto:4e3,callback:function(e,n){$(".swipe-circle").eq(i.getPos()).addClass("active").siblings().removeClass("active")},transitionEnd:function(e,n){}});e=$("#slider .swipe-wrap").children().length;for(var t=0;t<e;t++)n+='<span class="swipe-circle '+(0==t?"active":"")+'"></span>';n+="</div>",$("#slider").append(n)},initEvent:function(){var e=this,n=Okay.util.debounce(function(){$(document).scrollTop()>e.upperLimit?e.scrollElem.removeClass("dn"):e.scrollElem.addClass("dn")},150);$(window).on("scroll",n),this.scrollElem.on("tap",function(){$("html, body").scrollTop(0),e.scrollElem.addClass("dn")}),$("#theme").on("tap",function(e){e.preventDefault(),$("#menu").show(),$("body").addClass("with-menu")}),$("#menu").on("tap","a",function(e){e.preventDefault(),$("#menu").hide(),window.location.href=$(this).data("href")}),$("#close").on("tap",function(e){e.preventDefault(),$("#menu").hide()}),$("#user").on("tap",function(){e.isLogin?window.location.href="user.html":window.location.href="login.html"}),$("#share").on("tap",function(){e.isShareOpen?$(".share-box").show():(e.isShareOpen=!0,$("body").append($("#"+(Okay.util.isInApp()?"app":"web")+"-share").html()))}),$(document).on("tap",".close",function(){$(".share-box").hide()})}};