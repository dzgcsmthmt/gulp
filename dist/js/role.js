function createRects(e){function t(e){var t=e?1160-WIDTH:r-50-WIDTH,n=50,a=c-n-HEIGHT,o=50+Math.ceil((t-50)*Math.random());return e&&(n=260),{x:o,y:n+Math.ceil((a-n)*Math.random())}}function n(e,t){if(!l.length)return!1;for(var n=0,a=l.length;n<a;n++){var o=t,i=e,s=i+WIDTH,r=o+HEIGHT,c=l[n].y,m=l[n].x,h=m+WIDTH,f=c+HEIGHT;if(!(r<c||i>h||o>f||s<m))return!0}return!1}var a,o,i=$("#rects"),s=$("#main"),r=i.width(),c=i.height(),l=[],m=(r-1180)/2;a=r>=1440?45:25;for(h=0;h<a;h++){for(o=t();n(o.x,o.y);)o=t();l.push(o),$('<div class="rect"></div>').css({top:o.y,left:o.x}).appendTo(i)}for(var h=0,f=Math.min(5,themes.length);h<f;h++){for(o=t(!0);n(o.x+m,o.y);)o=t(!0);l.push(o),$('<a class="top" id="top'+(h+1)+'" target="_blank" href="'+themes[h].href+'"></a>').css({top:o.y,left:o.x}).appendTo(s),o.x=o.x+m}e?moveIERects():moveRects()}function moveRects(){var e,t,n=$("#rects").find(".rect").filter(":not(.top)");setTimeout(function(){for(var a=0,o=n.length;a<o;a++)t=Math.floor(360*Math.random()),e="translate3d("+Math.round(50*Math.sin(t*Math.PI/180))+"px,"+Math.round(50*Math.cos(t*Math.PI/180))+"px,0)",n.eq(a).css({transform:e,opacity:0})},50)}function moveIERects(){var e,t=$("#rects").find(".rect").filter(":not(.top)"),n=0;for(t.length;n<t.length;n++)e=Math.floor(360*Math.random()),t.eq(n).animate({top:"+="+Math.round(50*Math.sin(e*Math.PI/180)),left:"+="+Math.round(50*Math.cos(e*Math.PI/180))},2e3,function(){$(this).hide()})}function moveTops(){$("#rects"),$("#main");var e=0;$(".top").addClass("hl"),setTimeout(function(){for(var t=1,n=Math.min(5,themes.length);t<=n;t++)!function(t){setTimeout(function(){var a=t;$("#top"+t).animate({width:105,height:70,top:255+(t-1)*TEHME_HEIGHT,left:310-30*(t-1)},800,function(){$(this).css({"z-index":5,height:TEHME_HEIGHT}),$(this).addClass("top-item clearfix center").removeClass("top").html(createHtml(a,!0)).find(".img-hover").addClass("panel-hover hl").end().animate({width:TEHME_WIDTH},350,function(){$(this).find(".img-hover").removeClass("hl"),$(this).find("span").css("opacity",1).end().find(".img").addClass("panel"),++e==n&&moveOthers(e)})})},300*t)}(t)},500)}function moveOthers(e){var t=$("#rects"),n=$("#main"),a=t.height(),o=themes.length,i=o-e;a+=i*TEHME_HEIGHT,t.height(a);for(s=e;s<o;s++)$('<a class="top-item clearfix center show other-theme" target="_blank" href="'+themes[s].href+'"></a>').html(createHtml(s+1)).css({top:255+(o+1)*TEHME_HEIGHT,left:310-30*s,"z-index":5}).appendTo(n);for(var s=0;s<i;s++)!function(e){setTimeout(function(){$(".other-theme").eq(e).animate({top:615+(e+1)*TEHME_HEIGHT,opacity:1},1e3)},200*e)}(s);setTimeout(function(){$("#footer").show()},200*i+1e3)}function createHtml(e,t){var n="";return n+=t?'<img src="/themes/okayofficeweb/Public/assets/img/panel3.png" alt="" class="img"><img src="/themes/okayofficeweb/Public/assets/img/panel3_hover.png" alt="" class="img-hover">':'<img src="/themes/okayofficeweb/Public/assets/img/panel3.png" alt="" class="img panel"><img src="/themes/okayofficeweb/Public/assets/img/panel3_hover.png" alt="" class="img-hover panel-hover">',t?(n+='<span class="percent-value fl ml-55">'+themes[e-1].percent+'</span><span class="percent fl">%</span>',n+='<span class="concern-role fl ml-5 mr-5"><span>的'+themeName+"</span><span>关注</span></span>"):n+='<span class="fl ml-55 center hl">其他热门关注</span>',n+='<span class="concern-content fl ml-65">'+themes[e-1].theme+"</span>",n+='<i class="icon arrow"></i>'}var t,talkboxHtml,WIDTH=70,HEIGHT=50,TEHME_WIDTH=810,TEHME_HEIGHT=90;"undefined"!=typeof TimelineMax?(t=new TimelineMax,createRects(!0),talkboxHtml=$("#talkbox").html(),$("#talkbox").html('<div id="inner">'+talkboxHtml+"</div>"),$("#yun").animate({left:"-=450px"},500,"swing",function(){function e(){$("#yun").animate({top:"-=20px"},2e3,"swing",function(){$("#yun").animate({top:"+=20px"},2e3,"swing",function(){e()})})}e(),moveIERects(),setTimeout(function(){moveTops()},500),t.to("#inner",.35,{left:0,ease:Linear.easeOut,onComplete:function(){t.to("#inner p",.15,{autoAlpha:1,ease:Linear.easeIn})}},3.65)}),$("a").on("click",function(){$(this).blur()})):(createRects(),$("#wrapper").iosParallax({movementFactor:50}),$("#yun").one("animationend webkitAnimationEnd oAnimationEnd",function(){$("#yun1").hide(),$(this).css({left:"130px",opacity:1}).addClass("up-down"),$("#move").addClass("motion"),setTimeout(function(){moveTops()},500)})),$(".wgt-customer-service .function-feedback").on("click",function(e){e.preventDefault(),window.easemobim.bind({hide:!0,tenantId:2782,autoConnect:!0,to:"kefuchannelimid_889489",appKey:"1157161207178432#kefuchannelapp2782",visitor:{trueName:"OKAY官网",userNickname:"OKAY官网"}})});